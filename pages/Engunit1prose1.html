<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sea Turtles - Interactive Learning</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lottie Animation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.7.14/lottie.min.js"></script>
    
    <!-- Canvas Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: #f5f5f5;
        }

        /* Level Container */
        .level-container {
            max-width: 1000px;
            margin: 20px auto;
            padding: 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        /* Level Header */
        .level-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
            padding: 15px;
            background: #FF9B3F;
            border-radius: 10px;
            color: white;
        }

        .level-number {
            font-size: 2rem;
            font-weight: bold;
        }

        .level-title {
            font-size: 1.5rem;
        }

        /* Content Area */
        .content-area {
            padding: 20px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
        }

        .content-area.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Interactive Word */
        .interactive-word {
            color: #FF9B3F;
            cursor: pointer;
            position: relative;
            padding: 0 4px;
            transition: all 0.3s ease;
            font-size: 2rem !important;
        }

        .interactive-word:hover {
            background: #fff3e6;
            border-radius: 4px;
        }

        .tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 10px 15px;
            border-radius: 6px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            font-size: 1.25rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 100;
        }

        .interactive-word:hover .tooltip {
            opacity: 1;
            visibility: visible;
        }

        /* Navigation Button */
        .nav-button {
            background: #FF9B3F;
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 20px auto;
            transition: all 0.3s ease;
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 155, 63, 0.3);
        }

        .turtle-container {
            width: 200px;
            height: 200px;
            position: relative;
            animation: float 3s ease-in-out infinite;
            transform-style: preserve-3d;
            perspective: 1000px;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-10px) rotate(2deg); }
            75% { transform: translateY(5px) rotate(-2deg); }
        }

        .turtle {
            width: 140px;
            height: 90px;
            background: linear-gradient(145deg, #2E8B57, #3CB371);
            border-radius: 60% 60% 60% 60% / 70% 70% 50% 50%;
            position: relative;
            margin: 40px auto;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transform-style: preserve-3d;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .turtle::before {  /* Head */
            content: '';
            position: absolute;
            width: 35px;
            height: 30px;
            background: linear-gradient(145deg, #2E8B57, #3CB371);
            border-radius: 60% 50% 50% 50%;
            left: -20px;
            top: 30px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .turtle::after {  /* Tail */
            content: '';
            position: absolute;
            width: 25px;
            height: 20px;
            background: linear-gradient(145deg, #2E8B57, #3CB371);
            border-radius: 50% 50% 50% 60%;
            right: -15px;
            top: 35px;
        }

        .flipper {
            position: absolute;
            width: 50px;
            height: 20px;
            background: linear-gradient(145deg, #2E8B57, #3CB371);
            border-radius: 60% 40% 40% 60%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .flipper-front {
            left: 15px;
            top: 20px;
            transform-origin: left center;
            animation: swim-front 2s ease-in-out infinite;
        }

        .flipper-back {
            right: 15px;
            top: 20px;
            transform-origin: right center;
            animation: swim-back 2s ease-in-out infinite;
        }

        @keyframes swim-front {
            0%, 100% { transform: rotate(-20deg) translateY(0); }
            50% { transform: rotate(30deg) translateY(-5px); }
        }

        @keyframes swim-back {
            0%, 100% { transform: rotate(20deg) translateY(0); }
            50% { transform: rotate(-30deg) translateY(-5px); }
        }

        .shell-pattern {
            position: absolute;
            width: 100px;
            height: 65px;
            border: 3px solid rgba(255,255,255,0.2);
            border-radius: 50%;
            top: 12px;
            left: 20px;
            transform: rotate(-5deg);
        }

        .shell-pattern::before {
            content: '';
            position: absolute;
            width: 80px;
            height: 50px;
            border: 2px solid rgba(255,255,255,0.15);
            border-radius: 50%;
            top: 5px;
            left: 8px;
        }

        .shell-pattern::after {
            content: '';
            position: absolute;
            width: 60px;
            height: 35px;
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 50%;
            top: 12px;
            left: 18px;
        }

        .eye {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #000;
            border-radius: 50%;
            left: -12px;
            top: 35px;
            box-shadow: 0 0 0 2px rgba(255,255,255,0.6);
        }

        .bubbles {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .bubble {
            position: absolute;
            background: rgba(255,255,255,0.4);
            border-radius: 50%;
            animation: bubble-rise 3s ease-out infinite;
        }

        @keyframes bubble-rise {
            0% { 
                transform: translateY(0) scale(0.1); 
                opacity: 0; 
            }
            20% { opacity: 0.8; }
            100% { 
                transform: translateY(-100px) scale(1.5); 
                opacity: 0; 
            }
        }

        /* Water Effect */
        .water-container {
            position: relative;
            width: 100%;
            height: 200px;
            overflow: hidden;
            border-radius: 10px;
            background: linear-gradient(180deg, #a8e6ff 0%, #4db6e5 100%);
            margin-bottom: 20px;
        }

        .ripple {
            position: absolute;
            border: 2px solid rgba(255, 255, 255, 0.4);
            border-radius: 50%;
            animation: ripple 3s linear infinite;
            pointer-events: none;
        }

        @keyframes ripple {
            0% { width: 0; height: 0; opacity: 0.8; }
            100% { width: 100px; height: 100px; opacity: 0; }
        }

        /* Enhanced Turtle Animation */
        .turtle.swimming-fast {
            animation: swim-fast 1.5s ease-in-out infinite;
        }

        .turtle.diving {
            animation: dive 2s ease-in-out;
        }

        @keyframes swim-fast {
            0%, 100% { transform: translateX(0) rotate(0deg); }
            25% { transform: translateX(10px) rotate(5deg); }
            75% { transform: translateX(-10px) rotate(-5deg); }
        }

        @keyframes dive {
            0% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(50px) rotate(45deg) scale(0.8); }
            100% { transform: translateY(0) rotate(0deg); }
        }

        /* Water Surface */
        .water-surface {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 20px;
            background: linear-gradient(180deg, rgba(255,255,255,0.4) 0%, transparent 100%);
            animation: surface-move 3s ease-in-out infinite;
        }

        @keyframes surface-move {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(5px); }
        }

        /* Particle Effects */
        .particle {
            position: absolute;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 50%;
            pointer-events: none;
            z-index: 1;
        }

        /* Sound Controls */
        .controls-panel {
            position: fixed;
            bottom: 20px;
            left: 20px;
            display: flex;
            gap: 10px;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px;
            border-radius: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        .control-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: #FF9B3F;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            transform: scale(1.1);
        }

        .control-btn.active {
            background: #2E8B57;
        }

        /* Read Aloud Highlight */
        .reading-highlight {
            background: none;
        }

        /* Mobile Improvements */
        @media (max-width: 768px) {
            .level-container {
                margin: 10px;
                padding: 15px;
            }

            .controls-panel {
                bottom: 10px;
                left: 50%;
                transform: translateX(-50%);
                flex-wrap: wrap;
                justify-content: center;
            }

            .water-container {
                height: 150px;
            }

            .turtle {
                transform: scale(0.8);
            }

            .flex {
                flex-direction: column;
            }
        }
        
        /* Update these styles */
        .text-lg {
            line-height: 1.6;
            position: relative;
            font-size: 2rem !important;
            color: #333;
            margin-bottom: 1.5rem;
        }

        .word {
            display: inline;
            padding: 2px;
            border-radius: 3px;
            transition: all 0.3s ease;
        }

        .word.active {
            background-color: rgba(255, 215, 0, 0.5);  /* Semi-transparent gold */
            padding: 2px 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border-radius: 4px;
        }

        /* Special handling for interactive words */
        .interactive-word .word.active {
            background: #2E8B57;
        }

        /* Remove old styles that might conflict */
        .highlight-word,
        .current-word {
            display: none;
        }

        /* New styles */
        .sound-on, .sound-off {
            transition: all 0.3s ease;
        }

        .control-btn.muted .sound-on {
            display: none;
        }

        .control-btn.muted .sound-off {
            display: block;
        }

        .control-btn.muted {
            background: #ff6b6b;
        }

        .control-btn.active {
            background: #2E8B57;
        }

        /* Add these styles for the image container */
        .image-container {
            overflow: hidden;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .image-container img {
            display: block;
            width: 100%;
            height: auto;
            transition: transform 0.3s ease;
        }

        .image-container:hover img {
            transform: scale(1.05);
        }

        /* Add styles for the back button */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 2rem;
        }

        .back-button {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: #6B7280;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .back-button:hover {
            background: #4B5563;
            transform: translateX(-5px);
        }

        .nav-button {
            margin: 0;  /* Reset margin since it's now in a flex container */
        }

        /* Add these styles to your existing CSS */
        .quiz-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .quiz-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .statement {
            font-size: 1.25rem;
            color: #333;
            flex: 1;
        }

        .answer-buttons {
            display: flex;
            gap: 1rem;
        }

        .answer-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid #FF9B3F;
            background: white;
            color: #FF9B3F;
            font-size: 1.25rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .answer-btn:hover {
            background: #FF9B3F;
            color: white;
        }

        .answer-btn.selected {
            background: #FF9B3F;
            color: white;
        }

        .answer-btn.correct.selected {
            background: #2ECC71;
            border-color: #2ECC71;
            color: white;
        }

        .answer-btn.incorrect.selected {
            background: #E74C3C;
            border-color: #E74C3C;
            color: white;
        }

        .check-answers-btn {
            background: #FF9B3F;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .check-answers-btn:hover {
            background: #ff8921;
            transform: translateY(-2px);
        }

        /* Add these styles for the result board */
        .result-board {
            text-align: center;
            padding: 2rem;
            margin-top: 2rem;
            background: #fff;
            border-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .score-title {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 1rem;
        }

        .score-number {
            font-size: 3rem;
            font-weight: bold;
            color: #FF9B3F;
            margin-bottom: 1rem;
        }

        .badges-container {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 1rem 0;
        }

        .badge {
            width: 60px;
            height: 60px;
            animation: popIn 0.5s ease-out;
        }

        .feedback-message {
            font-size: 1.25rem;
            margin: 1rem 0;
            color: #333;
        }

        .try-again-btn {
            background: #FF9B3F;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }

        @keyframes popIn {
            0% { transform: scale(0); }
            70% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .celebration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #eee;
            border-radius: 5px;
            margin-bottom: 2rem;
            position: relative;
        }

        .progress {
            height: 100%;
            background: #FF9B3F;
            border-radius: 5px;
            width: 0%;
            transition: width 0.3s ease;
        }

        .question-counter {
            text-align: center;
            margin-top: 0.5rem;
            font-size: 1.1rem;
            color: #666;
        }

        .feedback-overlay {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4rem;
            z-index: 1000;
            animation: feedbackPop 1s ease-out;
        }

        @keyframes feedbackPop {
            0% { transform: translate(-50%, -50%) scale(0); }
            50% { transform: translate(-50%, -50%) scale(1.2); }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
        }

        .answer-summary {
            margin: 1rem 0;
            font-size: 1.2rem;
        }

        .correct-answers {
            color: #2ECC71;
        }

        .incorrect-answers {
            color: #E74C3C;
        }

        /* Ocean background */
        .quiz-container {
            max-width: 800px;
            margin: 0 auto;
            background: linear-gradient(180deg, #87CEEB 0%, #1E90FF 100%);
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        /* Animated waves */
        .quiz-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 10px;
            background: url('data:image/svg+xml,<svg viewBox="0 0 1200 120" xmlns="http://www.w3.org/2000/svg"><path d="M0,0V46.29c47.79,22.2,103.59,32.17,158,28,70.36-5.37,136.33-33.31,206.8-37.5C438.64,32.43,512.34,53.67,583,72.05c69.27,18,138.3,24.88,209.4,13.08,36.15-6,69.85-17.84,104.45-29.34C989.49,25,1113-14.29,1200,52.47V0Z" fill="%23ffffff" opacity=".25"/></svg>') repeat-x;
            animation: wave 15s linear infinite;
        }

        @keyframes wave {
            0% { background-position-x: 0; }
            100% { background-position-x: 1200px; }
        }

        /* Progress bar styling */
        .progress-bar {
            background: rgba(255,255,255,0.3);
            height: 15px;
            border-radius: 10px;
            overflow: hidden;
            border: 2px solid rgba(255,255,255,0.5);
        }

        .progress {
            background: linear-gradient(90deg, #FFD700, #FFA500);
            box-shadow: 0 0 10px rgba(255,165,0,0.5);
        }

        /* Question counter */
        .question-counter {
            color: white;
            font-size: 1.3rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
            font-weight: bold;
        }

        /* Question styling */
        .quiz-item {
            background: rgba(255,255,255,0.9);
            border-radius: 15px;
            padding: 1.5rem;
            margin: 1rem 0;
            transform: translateY(0);
            transition: all 0.3s ease;
            border: 3px solid rgba(255,255,255,0.8);
        }

        .quiz-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .statement {
            font-size: 1.4rem;
            color: #2C3E50;
            font-weight: 500;
        }

        /* Answer buttons */
        .answer-buttons {
            gap: 1.5rem;
        }

        .answer-btn {
            width: 50px;
            height: 50px;
            font-size: 1.5rem;
            border: 3px solid #FF9B3F;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transform: translateY(0);
            transition: all 0.2s ease;
        }

        .answer-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        /* Feedback overlay */
        .feedback-overlay {
            font-size: 6rem;
            text-shadow: 0 0 20px rgba(255,255,255,0.5);
            animation: feedbackPop 1.2s cubic-bezier(0.36, 0, 0.66, -0.56);
        }

        /* Result board styling */
        .result-board {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 3rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
        }

        .score-number {
            font-size: 4rem;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        /* Decorative elements */
        .sea-turtle-icon {
            position: absolute;
            width: 80px;
            height: 80px;
            opacity: 0.2;
        }

        .sea-turtle-icon.top-right {
            top: 20px;
            right: 20px;
            transform: rotate(45deg);
        }

        .sea-turtle-icon.bottom-left {
            bottom: 20px;
            left: 20px;
            transform: rotate(-135deg);
        }

        /* Add these styles to enhance the gamified experience */

        /* Add glow effect to correct answers */
        .answer-btn.correct.selected {
            box-shadow: 0 0 15px #2ECC71;
            border-color: #2ECC71;
            background: #2ECC71;
            color: white;
        }

        /* Add shake effect for incorrect answers */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .answer-btn.incorrect.selected {
            animation: shake 0.3s ease-in-out;
            box-shadow: 0 0 15px #E74C3C;
            border-color: #E74C3C;
            background: #E74C3C;
            color: white;
        }

        /* Enhance result board */
        .result-title {
            font-size: 2.5rem;
            color: #2C3E50;
            margin-bottom: 1.5rem;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        /* Add floating animation to turtle icons */
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(45deg); }
            50% { transform: translateY(-10px) rotate(45deg); }
        }

        .sea-turtle-icon.top-right {
            animation: float 3s ease-in-out infinite;
        }

        @keyframes floatReverse {
            0%, 100% { transform: translateY(0) rotate(-135deg); }
            50% { transform: translateY(10px) rotate(-135deg); }
        }

        .sea-turtle-icon.bottom-left {
            animation: floatReverse 3s ease-in-out infinite;
        }

        /* Add level 5 content with drag-drop matching game */
        .glossary-container {
            max-width: 800px;
            margin: 0 auto;
            background: linear-gradient(180deg, #87CEEB 0%, #1E90FF 100%);
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .glossary-instructions {
            color: white;
            font-size: 1.5rem;
            text-align: center;
            margin-bottom: 2rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        .matching-game {
            display: flex;
            justify-content: space-between;
            gap: 3rem;
            margin: 2rem 0;
        }

        .words-container, .definitions-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .word {
            background: white;
            padding: 1rem;
            border-radius: 10px;
            text-align: center;
            cursor: move;
            font-size: 1.2rem;
            color: #2C3E50;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .word:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .word.dragging {
            opacity: 0.5;
            transform: scale(1.05);
        }

        .definition {
            min-height: 80px;
            border: 2px dashed rgba(255,255,255,0.5);
            border-radius: 10px;
            padding: 0.5rem;
        }

        .definition-box {
            background: rgba(255,255,255,0.9);
            padding: 1rem;
            border-radius: 8px;
            font-size: 1.1rem;
            color: #2C3E50;
        }

        .definition.correct {
            border-color: #2ECC71;
            background: rgba(46, 204, 113, 0.1);
        }

        .definition.hover {
            background: rgba(255,255,255,0.1);
            border-style: solid;
        }

        /* Add these styles for improved Level 5 feedback and appearance */
        .glossary-container {
            background: linear-gradient(180deg, #87CEEB 0%, #1E90FF 100%),
                        url('/img/underwater-bg.png');
            background-blend-mode: soft-light;
            background-size: cover;  /* Makes image cover the container */
            background-position: center;  /* Centers the background image */
            background-repeat: no-repeat;  /* Prevents image from repeating */
            padding: 3rem;
            min-height: 600px;  /* Ensures container has enough height to show background */
        }

        .glossary-instructions {
            font-size: 1.8rem;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            background: rgba(255, 255, 255, 0.1);
            padding: 1rem;
            border-radius: 15px;
            backdrop-filter: blur(5px);
        }

        .word {
            background: linear-gradient(135deg, #fff 0%, #f0f0f0 100%);
            transform-style: preserve-3d;
            transition: all 0.3s ease;
        }

        .word:hover {
            transform: translateY(-5px) rotateX(10deg);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .definition {
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
        }

        .definition.hover {
            transform: scale(1.02);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        }

        .definition.correct {
            animation: correctMatch 0.5s ease-out;
            border-color: #2ECC71;
            background: rgba(46, 204, 113, 0.1);
        }

        .definition.incorrect {
            animation: incorrectMatch 0.5s ease-out;
            border-color: #E74C3C;
            background: rgba(231, 76, 60, 0.1);
        }

        @keyframes correctMatch {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes incorrectMatch {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
            100% { transform: translateX(0); }
        }

        /* Feedback overlay for glossary */
        .glossary-feedback {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 6rem;
            z-index: 1000;
            text-shadow: 0 0 20px rgba(255,255,255,0.5);
            animation: feedbackPop 0.8s cubic-bezier(0.36, 0, 0.66, -0.56);
            pointer-events: none;
        }

        
    </style>
</head>
<body>
    <div class="level-container">
        <div class="level-header">
            <div class="level-number">1</div>
            <div class="level-title">Introduction to Sea Turtles</div>
                </div>

        <div class="content-area" id="contentArea">
            <div class="flex gap-8">
                <div class="flex-1">
                    <p class="text-lg leading-relaxed mb-4">
                        Most of us have seen a 
                        <span class="interactive-word">
                            tortoise
                            <span class="tooltip">A land-dwelling reptile with a hard shell</span>
                        </span>
                        in a zoo or a reptile park. However, not many would have seen its 
                        <span class="interactive-word">
                            marine
                            <span class="tooltip">Related to or found in the sea</span>
                        </span>
                        relative, the sea turtle. This is not surprising, since these reptiles spend almost their entire life in the sea.
                    </p>
            </div>
                <div class="w-1/3">
                    <div id="turtleAnimation"></div>
        </div>
    </div>

            <button class="nav-button" onclick="completeLevel()">
                I'm Ready to Learn More!
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                    </svg>
                </button>
            </div>
            </div>

    <script>
        // Replace the sounds initialization with this error-handled version
        const sounds = {
            splash: null,
            bubble: null,
            swim: null
        };

        // Try to load sounds with error handling
        try {
            sounds.splash = new Audio('/sounds/splash.mp3');
            sounds.bubble = new Audio('/sounds/bubble.mp3');
            sounds.swim = new Audio('/sounds/swim.mp3');
            
            // Initialize volume if sounds loaded successfully
            Object.values(sounds).forEach(sound => {
                if (sound) sound.volume = 0.3;
            });
        } catch (error) {
            console.log('Sound effects not available');
        }

        // Update the sound playing functions to check if sound exists
        function playSound(soundName) {
            const currentLevel = parseInt(document.querySelector('.level-number')?.textContent);
            if (currentLevel === 1 && sounds[soundName]) {
                sounds[soundName].currentTime = 0;
                sounds[soundName].play().catch(err => console.log('Sound playback failed'));
            }
        }

        // Update the turtleHTML constant
        const turtleHTML = `
            <div class="water-container">
                <div class="water-surface"></div>
                <div class="turtle-container">
                    <div class="bubbles">
                        ${Array.from({length: 8}, (_, i) => `
                            <div class="bubble" style="
                                width: ${Math.random() * 10 + 5}px;
                                height: ${Math.random() * 10 + 5}px;
                                left: ${Math.random() * 100}%;
                                animation-delay: ${Math.random() * 2}s;
                            "></div>
                        `).join('')}
        </div>
                    <div class="turtle" id="interactiveTurtle">
                        <div class="eye"></div>
                        <div class="flipper flipper-front"></div>
                        <div class="flipper flipper-back"></div>
                        <div class="shell-pattern"></div>
                    </div>
                </div>
            </div>
        `;

        // Add this before the DOMContentLoaded event listener
        const newStyles = `
            .sound-on, .sound-off {
                transition: all 0.3s ease;
            }

            .control-btn.muted .sound-on {
                display: none;
            }

            .control-btn.muted .sound-off {
                display: block;
            }

            .control-btn.muted {
                background: #ff6b6b;
            }

            .control-btn.active {
                background: #2E8B57;
            }
        `;

        // Update the DOMContentLoaded event listener
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize turtle animation for level 1
            const turtleContainer = document.getElementById('turtleAnimation');
            if (turtleContainer) {
                turtleContainer.innerHTML = turtleHTML;
                initializeTurtleAnimations();
            }

            // Initialize speech and controls
            const speechManager = new SpeechManager();
            document.body.insertAdjacentHTML('beforeend', controlsHTML);

            // Add the new styles
            const styleSheet = document.createElement('style');
            styleSheet.textContent = newStyles;
            document.head.appendChild(styleSheet);

            // Initialize sound state
            let isMuted = false;

            // Sound toggle button with improved functionality
            const soundToggle = document.getElementById('soundToggle');
            soundToggle.addEventListener('click', () => {
                isMuted = !isMuted;
                
                // Update button appearance
                soundToggle.classList.toggle('muted', isMuted);
                
                // Update all audio elements
                Object.values(sounds).forEach(sound => {
                    if (sound) {
                        sound.muted = isMuted;
                    }
                });

                // Update speech synthesis
                if (isMuted) {
                    window.speechSynthesis.cancel();
                }

                // Store preference
                localStorage.setItem('soundMuted', isMuted);
            });

            // Load saved preference
            const savedMuted = localStorage.getItem('soundMuted') === 'true';
            if (savedMuted) {
                isMuted = true;
                soundToggle.classList.add('muted');
                Object.values(sounds).forEach(sound => {
                    if (sound) sound.muted = true;
                });
            }

            // Read aloud button
            const readAloud = document.getElementById('readAloud');
            readAloud.addEventListener('click', () => {
                readAloud.classList.toggle('active');
                document.querySelector('.text-lg').classList.toggle('reading-highlight');
                
                // If already speaking, this will stop it
                if (speechManager.speaking) {
                    readAloud.classList.remove('active');
                    document.querySelector('.text-lg').classList.remove('reading-highlight');
                    window.speechSynthesis.cancel();
                    speechManager.speaking = false;
                    return;
                }
                
                speechManager.speak();
            });

            // Show content with animation
            setTimeout(() => {
                document.getElementById('contentArea').classList.add('visible');
            }, 500);

            // Add turtle animations back
            const turtle = document.getElementById('interactiveTurtle');
            const container = document.querySelector('.water-container');
            let isSwimmingFast = false;
            let currentPattern = 0;
            const patterns = ['swimming-pattern-1', 'swimming-pattern-2', 'swimming-pattern-3'];

            // Cursor following
            container.addEventListener('mousemove', (e) => {
                const rect = container.getBoundingClientRect();
                const x = e.clientX - rect.left - turtle.offsetWidth / 2;
                const y = e.clientY - rect.top - turtle.offsetHeight / 2;

                // Keep turtle within container bounds
                const maxX = container.offsetWidth - turtle.offsetWidth;
                const maxY = container.offsetHeight - turtle.offsetHeight;
                const boundedX = Math.min(Math.max(0, x), maxX);
                const boundedY = Math.min(Math.max(0, y), maxY);

                turtle.style.transform = `translate(${boundedX}px, ${boundedY}px)`;
            });

            // Click to dive with sound
            turtle.addEventListener('click', () => {
                if (!turtle.classList.contains('diving')) {
                    playSound('splash');
                    turtle.classList.add('diving');
                    createRippleEffect(event);
                    setTimeout(() => {
                        turtle.classList.remove('diving');
                    }, 2000);
                }
            });

            // Double click to change swimming pattern
            turtle.addEventListener('dblclick', () => {
                // Remove current pattern
                patterns.forEach(pattern => turtle.classList.remove(pattern));
                
                // Add next pattern
                currentPattern = (currentPattern + 1) % patterns.length;
                turtle.classList.add(patterns[currentPattern]);
                
                playSound('swim');
                updateBubbleSpeed(currentPattern === 1); // Fast bubbles for pattern 1
            });

            // Create bubbles periodically
            setInterval(() => {
                if (Math.random() > 0.7) { // 30% chance to create bubble
                    createBubble(turtle.offsetLeft + turtle.offsetWidth / 2, 
                                turtle.offsetTop + turtle.offsetHeight / 2);
                    playSound('bubble');
                }
            }, 1000);
        });

        function createBubble(x, y) {
            const container = document.querySelector('.water-container');
            if (!container) return; // Guard clause if container doesn't exist
            
            const bubbles = container.querySelector('.bubbles');
            if (!bubbles) {
                const bubblesDiv = document.createElement('div');
                bubblesDiv.className = 'bubbles';
                container.appendChild(bubblesDiv);
            }

            const bubble = document.createElement('div');
            bubble.className = 'bubble';
            bubble.style.left = `${x}px`;
            bubble.style.top = `${y}px`;
            bubble.style.width = `${Math.random() * 10 + 5}px`;
            bubble.style.height = bubble.style.width;
            bubble.style.animationDuration = '3s';
            
            (bubbles || container.querySelector('.bubbles')).appendChild(bubble);
            setTimeout(() => bubble.remove(), 3000);
        }

        function createRippleEffect(e) {
            const ripple = document.createElement('div');
            ripple.className = 'ripple';
            
            const rect = e.target.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            ripple.style.left = `${x}px`;
            ripple.style.top = `${y}px`;
            
            e.target.appendChild(ripple);
            setTimeout(() => ripple.remove(), 3000);
        }

        function updateBubbleSpeed(isFast) {
            const bubbles = document.querySelectorAll('.bubble');
            bubbles.forEach(bubble => {
                bubble.style.animationDuration = isFast ? '1.5s' : '3s';
            });
        }

        function completeLevel() {
            const contentArea = document.getElementById('contentArea');
            const levelContainer = document.querySelector('.level-container');
            const currentLevel = parseInt(levelContainer.querySelector('.level-number').textContent);
            
            // Fade out current content
            contentArea.style.opacity = '0';
            contentArea.style.transform = 'translateY(-20px)';
            
            // After fade out, update content based on current level
            setTimeout(() => {
                switch(currentLevel) {
                    case 1:
                        levelContainer.innerHTML = level2Content;
                        break;
                    case 2:
                        levelContainer.innerHTML = level3Content;
                        break;
                    case 3:
                        levelContainer.innerHTML = level4Content;
                        initializeQuiz();
                        break;
                    case 4:
                        levelContainer.innerHTML = level5Content;
                        initializeGlossary();
                        break;
                    default:
                        console.log('All levels completed!');
                        return;
                }

                const newContentArea = document.getElementById('contentArea');
                
                // Fade in new content
                setTimeout(() => {
                    newContentArea.style.opacity = '1';
                    newContentArea.style.transform = 'translateY(0)';
                    newContentArea.classList.add('visible');
                }, 100);
            }, 500);
        }

        // Add this before the level2Content definition
        const level1Content = `
            <div class="level-header">
                <div class="level-number">1</div>
                <div class="level-title">Introduction to Sea Turtles</div>
        </div>

            <div class="content-area" id="contentArea">
                <div class="flex gap-8">
                    <div class="flex-1">
                        <p class="text-lg leading-relaxed mb-4">
                            Most of us have seen a 
                            <span class="interactive-word">
                                tortoise
                                <span class="tooltip">A land-dwelling reptile with a hard shell</span>
                            </span>
                            in a zoo or a reptile park. However, not many would have seen its 
                            <span class="interactive-word">
                                marine
                                <span class="tooltip">Related to or found in the sea</span>
                            </span>
                            relative, the sea turtle. This is not surprising, since these reptiles spend almost their entire life in the sea.
                        </p>
                    </div>
                    <div class="w-1/3">
                        <div id="turtleAnimation"></div>
                    </div>
                </div>

                <button class="nav-button" onclick="completeLevel()">
                    Continue to Next Level
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                    </svg>
                </button>
                </div>
        `;

        // Update the level2Content to include the continue button
        const level2Content = `
            <div class="level-header">
                <div class="level-number">2</div>
                <div class="level-title">Sea Turtle Species</div>
                </div>

            <div class="content-area" id="contentArea">
                <div class="flex gap-8">
                    <div class="flex-1">
                        <p class="text-lg leading-relaxed mb-4" style="font-size: 2rem;">
                            There are seven species of marine or sea turtles in the world. Of them, five are found in India's coastal waters: the 
                            <span class="interactive-word">
                                Olive Ridley
                                <span class="tooltip">The smallest species of sea turtle</span>
                            </span>
                            , the Hawksbill, the Green Sea Turtle, the Loggerhead and the 
                            <span class="interactive-word">
                                Leatherback
                                <span class="tooltip">The largest species of sea turtle</span>
                            </span>
                            . Compared to most tortoises, sea turtles are huge. Even the smallest species, the Olive Ridley, weighs up to 35 kg when fully grown. The largest of them all, the Leatherback, grows to a length of 2.2m and each could weigh as much as 700 kg!
                    </p>
                </div>
                    <div class="w-1/3">
                        <div class="image-container">
                            <img 
                                src="/img/sea-turtle-species.jpg" 
                                alt="Different Species of Sea Turtles"
                                class="rounded-lg shadow-lg hover:scale-105 transition-transform duration-300"
                            />
                        </div>
                    </div>
                </div>

                <div class="nav-buttons">
                    <button class="back-button" onclick="goBack()">
                        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 17l-5-5m0 0l5-5m-5 5h12"/>
                        </svg>
                        Go Back
                    </button>
                    <button class="nav-button" onclick="completeLevel()">
                        Continue to Next Level
                        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                        </svg>
                    </button>
                </div>
            </div>
        `;

        // Update the level3Content to include the continue button
        const level3Content = `
            <div class="level-header">
                <div class="level-number">3</div>
                <div class="level-title">Sea Turtle Habitats</div>
            </div>

            <div class="content-area" id="contentArea">
                <div class="flex gap-8">
                    <div class="flex-1">
                        <p class="text-lg leading-relaxed mb-4">
                            Sea turtles live their life entirely in the 
                            <span class="interactive-word">
                                oceans
                                <span class="tooltip">Large bodies of saltwater that cover most of Earth's surface</span>
                            </span>
                            . But they still have a connection with land – they must come ashore to lay eggs. Today, four of the sea turtle species mentioned above have become extremely rare in India. The Olive Ridleys, however, are still commonly seen 
                            <span class="interactive-word">
                                nesting
                                <span class="tooltip">Building nests and laying eggs</span>
                            </span>
                            on sandy beaches all along our coasts.
                    </p>
                </div>
                    <div class="w-1/3">
                        <div class="image-container">
                            <img 
                                src="/img/sea-turtle-nesting.png" 
                                alt="Sea Turtle Nesting on Beach"
                                class="rounded-lg shadow-lg hover:scale-105 transition-transform duration-300"
                            />
                        </div>
                    </div>
                </div>

                <div class="nav-buttons">
                    <button class="back-button" onclick="goBack()">
                        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 17l-5-5m0 0l5-5m-5 5h12"/>
                        </svg>
                        Go Back
                    </button>
                    <button class="nav-button" onclick="completeLevel()">
                        Continue to Quiz
                        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                        </svg>
                    </button>
                    </div>
                    </div>
        `;

        // Update the quiz buttons in level4Content
        const level4Content = `
            <div class="level-header">
                <div class="level-number">4</div>
                <div class="level-title">Sea Turtle Quiz Challenge</div>
                </div>

            <div class="content-area" id="contentArea">
                <div class="quiz-container">
                    <!-- Decorative turtle icons -->
                    <img src="/img/turtle-icon.png" class="sea-turtle-icon top-right" alt="">
                    <img src="/img/turtle-icon.png" class="sea-turtle-icon bottom-left" alt="">

                    <div class="progress-bar">
                        <div class="progress"></div>
                        <div class="question-counter">Question <span id="currentQuestion">1</span> of 7</div>
                </div>

                    <div class="quiz-items">
                        <!-- Questions will be inserted here -->
                        </div>

                    <div class="result-board" style="display: none;">
                        <h2 class="result-title">Quiz Complete!</h2>
                        <div class="score-display">
                            <div class="score-number"><span id="score">0</span>/7</div>
                            <div class="score-percentage">(<span id="percentage">0</span>%)</div>
                        </div>
                        <div class="answer-summary">
                            <div class="correct-answers">
                                Correct Answers: <span id="correctCount">0</span>
                    </div>
                            <div class="incorrect-answers">
                                Incorrect Answers: <span id="incorrectCount">0</span>
                    </div>
                </div>
                        <div class="badges-container"></div>
                        <div class="feedback-message"></div>
                        <button class="try-again-btn" onclick="resetQuiz()">Try Again</button>
        </div>
                </div>

                <div class="nav-buttons mt-8">
                    <button class="back-button" onclick="goBack()">
                        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 17l-5-5m0 0l5-5m-5 5h12"/>
                            </svg>
                        Go Back
                    </button>
                        </div>
                        </div>
        `;

        // Add level 5 content with drag-drop matching game
        const level5Content = `
            <div class="level-header">
                <div class="level-number">5</div>
                <div class="level-title">Sea Turtle Glossary Challenge</div>
                    </div>

            <div class="content-area" id="contentArea">
                <div class="glossary-container">
                    <div class="glossary-instructions">
                        Drag each word to its matching definition!
                    </div>
                    
                    <div class="matching-game">
                        <div class="words-container">
                            <div class="word" draggable="true" data-word="marine">marine</div>
                            <div class="word" draggable="true" data-word="species">species</div>
                            <div class="word" draggable="true" data-word="coastal">coastal</div>
                </div>
                        
                        <div class="definitions-container">
                            <div class="definition" data-definition="marine">
                                <div class="definition-box">found in the sea</div>
        </div>
                            <div class="definition" data-definition="species">
                                <div class="definition-box">group of animals with common features</div>
                            </div>
                            <div class="definition" data-definition="coastal">
                                <div class="definition-box">land by the edge of a sea</div>
                            </div>
                        </div>
                    </div>

                    <div class="nav-buttons mt-8">
                        <button class="back-button" onclick="goBack()">
                            <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 17l-5-5m0 0l5-5m-5 5h12"/>
                    </svg>
                            Go Back
                        </button>
                    </div>
                </div>
            </div>
        `;

        // Update the SpeechManager class with highlighting functionality
        class SpeechManager {
            constructor() {
                this.synth = window.speechSynthesis;
                this.speaking = false;

                // Add speech styles only once when SpeechManager is initialized
                if (!document.getElementById('speechStyles')) {
                    const style = document.createElement('style');
                    style.id = 'speechStyles';
                    style.textContent = `
                        .word {
                            display: inline;
                            transition: background-color 0.2s ease;
                        }
                        .word.active {
                            background-color: rgba(255, 215, 0, 0.3);
                            border-radius: 4px;
                            padding: 0 2px;
                        }
                    `;
                    document.head.appendChild(style);
                }
            }

            speak(text) {
                if (this.speaking) {
                    this.synth.cancel();
                    this.speaking = false;
                    return;
                }

                const container = document.querySelector('.text-lg');
                const originalHTML = container.innerHTML;

                // First, remove tooltips from speech text
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = originalHTML;
                tempDiv.querySelectorAll('.tooltip').forEach(tooltip => tooltip.remove());
                const cleanText = tempDiv.textContent.trim();

                // Wrap words in spans while preserving interactive elements
                const wrapWords = (node) => {
                    if (node.nodeType === Node.TEXT_NODE) {
                        const words = node.textContent.trim().split(/\s+/);
                        if (words.length === 0) return node;

                        const fragment = document.createDocumentFragment();
                        words.forEach((word, i) => {
                            if (word) {
                                const span = document.createElement('span');
                                span.className = 'word';
                                span.textContent = word;
                                fragment.appendChild(span);
                                if (i < words.length - 1) {
                                    fragment.appendChild(document.createTextNode(' '));
                                }
                            }
                        });
                        return fragment;
                    }

                    if (node.nodeType === Node.ELEMENT_NODE) {
                        if (node.classList.contains('tooltip')) return null;
                        
                        const clone = node.cloneNode(false);
                        Array.from(node.childNodes).forEach(child => {
                            const processed = wrapWords(child);
                            if (processed) clone.appendChild(processed);
                        });
                        return clone;
                    }

                    return node;
                };

                const processedContainer = container.cloneNode(false);
                Array.from(container.childNodes).forEach(child => {
                    const processed = wrapWords(child);
                    if (processed) processedContainer.appendChild(processed);
                });
                container.replaceWith(processedContainer);

                const utterance = new SpeechSynthesisUtterance(cleanText);
                utterance.rate = 0.9;
                utterance.pitch = 1;
                utterance.lang = 'en-US';

                const words = Array.from(processedContainer.querySelectorAll('.word'));
                let currentIndex = 0;

                utterance.onboundary = (event) => {
                    if (event.name === 'word' && words[currentIndex]) {
                        words.forEach(word => word.classList.remove('active'));
                        words[currentIndex].classList.add('active');
                        currentIndex++;
                    }
                };

                utterance.onend = () => {
                    this.speaking = false;
                    processedContainer.replaceWith(container);
                    container.innerHTML = originalHTML;
                };

                utterance.onerror = () => {
                    this.speaking = false;
                    processedContainer.replaceWith(container);
                    container.innerHTML = originalHTML;
                };

                this.speaking = true;
                this.synth.speak(utterance);
            }
        }

        // Update the sound toggle button HTML with mute icon
        const controlsHTML = `
            <div class="controls-panel">
                <button class="control-btn" id="soundToggle" title="Toggle Sound">
                    <svg class="sound-on" width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                            d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"/>
                    </svg>
                    <svg class="sound-off" width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="display: none;">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                            d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15zM17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"/>
                    </svg>
                </button>
                <button class="control-btn" id="readAloud" title="Read Aloud">
                    <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                            d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0-11V3m0 0a7 7 0 017 7c0 1.462-.446 2.816-1.208 3.937"/>
                    </svg>
                </button>
            </div>
        `;

        // Update the goBack function
        function goBack() {
            const contentArea = document.getElementById('contentArea');
            const levelContainer = document.querySelector('.level-container');
            const currentLevel = parseInt(levelContainer.querySelector('.level-number').textContent);
            
            // Clean up any existing animations
            cleanupTurtleAnimations();
            
            // Fade out current content
            contentArea.style.opacity = '0';
            contentArea.style.transform = 'translateY(-20px)';
            
            // After fade out, update content based on current level
            setTimeout(() => {
                switch(currentLevel) {
                    case 2:
                        levelContainer.innerHTML = level1Content;
                        // Initialize turtle animation for level 1
                        const turtleContainer = document.getElementById('turtleAnimation');
                        if (turtleContainer) {
                            turtleContainer.innerHTML = turtleHTML;
                            initializeTurtleAnimations();
                        }
                        break;
                    case 3:
                        levelContainer.innerHTML = level2Content;
                        // Initialize level 2 content
                        const newContentArea = document.getElementById('contentArea');
                        if (newContentArea) {
                            newContentArea.style.opacity = '0';
                            setTimeout(() => {
                                newContentArea.style.opacity = '1';
                                newContentArea.style.transform = 'translateY(0)';
                                newContentArea.classList.add('visible');
                            }, 50);
                        }
                        break;
                    case 4:
                        levelContainer.innerHTML = level3Content;
                        // Initialize level 3 content
                        const newContentArea2 = document.getElementById('contentArea');
                        if (newContentArea2) {
                            newContentArea2.style.opacity = '0';
                            setTimeout(() => {
                                newContentArea2.style.opacity = '1';
                                newContentArea2.style.transform = 'translateY(0)';
                                newContentArea2.classList.add('visible');
                            }, 50);
                        }
                        break;
                    default:
                        return;
                }

                // Initialize speech and controls for the new content
                const speechManager = new SpeechManager();
                document.body.insertAdjacentHTML('beforeend', controlsHTML);

                // Initialize sound toggle
                const soundToggle = document.getElementById('soundToggle');
                if (soundToggle) {
                    soundToggle.addEventListener('click', () => {
                        const isMuted = !sounds.splash?.muted;
                        Object.values(sounds).forEach(sound => {
                            if (sound) sound.muted = isMuted;
                        });
                        soundToggle.classList.toggle('active', !isMuted);
                    });
                }

                // Initialize read aloud button
                const readAloud = document.getElementById('readAloud');
                if (readAloud) {
                    readAloud.addEventListener('click', () => {
                        readAloud.classList.toggle('active');
                        document.querySelector('.text-lg').classList.toggle('reading-highlight');
                        speechManager.speak();
                    });
                }

                // Show content with animation
                const newContent = document.getElementById('contentArea');
                setTimeout(() => {
                    newContent.style.opacity = '1';
                    newContent.style.transform = 'translateY(0)';
                    newContent.classList.add('visible');
                }, 100);
            }, 500);
        }

        // Update the initializeTurtleAnimations function to include error handling
        function initializeTurtleAnimations() {
            const turtle = document.getElementById('interactiveTurtle');
            const container = document.querySelector('.water-container');
            const currentLevel = parseInt(document.querySelector('.level-number')?.textContent);
            
            if (!turtle || !container) {
                console.log('Turtle animation elements not found');
                return;
            }

            // Ensure the turtle is visible and properly positioned
            turtle.style.display = 'block';
            turtle.style.position = 'absolute';
            turtle.style.transform = 'translate(0, 0)';

            let currentPattern = 0;
            const patterns = ['swimming-pattern-1', 'swimming-pattern-2', 'swimming-pattern-3'];

            // Mouse following functionality
            container.addEventListener('mousemove', (e) => {
                const rect = container.getBoundingClientRect();
                const x = e.clientX - rect.left - turtle.offsetWidth / 2;
                const y = e.clientY - rect.top - turtle.offsetHeight / 2;

                const maxX = container.offsetWidth - turtle.offsetWidth;
                const maxY = container.offsetHeight - turtle.offsetHeight;
                const boundedX = Math.min(Math.max(0, x), maxX);
                const boundedY = Math.min(Math.max(0, y), maxY);

                turtle.style.transform = `translate(${boundedX}px, ${boundedY}px)`;
            });

            // Only add sound-related event listeners in level 1
            if (currentLevel === 1) {
                // Click to dive with sound
                turtle.addEventListener('click', () => {
                    if (!turtle.classList.contains('diving')) {
                        playSound('splash');
                        turtle.classList.add('diving');
                        createRippleEffect(event);
                        setTimeout(() => turtle.classList.remove('diving'), 2000);
                    }
                });

                // Double click to change pattern with sound
                turtle.addEventListener('dblclick', () => {
                    patterns.forEach(pattern => turtle.classList.remove(pattern));
                    currentPattern = (currentPattern + 1) % patterns.length;
                    turtle.classList.add(patterns[currentPattern]);
                    playSound('swim');
                    updateBubbleSpeed(currentPattern === 1);
                });

                // Create bubbles with sound
                const bubbleInterval = setInterval(() => {
                    if (Math.random() > 0.7) {
                        createBubble(
                            turtle.offsetLeft + turtle.offsetWidth / 2,
                            turtle.offsetTop + turtle.offsetHeight / 2
                        );
                        playSound('bubble');
                    }
                }, 1000);

                // Store interval ID on the container for cleanup
                container.dataset.bubbleInterval = bubbleInterval;
            }
        }

        // Add a cleanup function for when switching levels
        function cleanupTurtleAnimations() {
            const container = document.querySelector('.water-container');
            if (container && container.dataset.bubbleInterval) {
                clearInterval(parseInt(container.dataset.bubbleInterval));
            }
        }

        // Quiz questions array
        const quizQuestions = [
            {
                statement: "1. Turtles are different from tortoises.",
                correct: true
            },
            {
                statement: "2. Turtles are sea animals.",
                correct: true
            },
            {
                statement: "3. There are seven kinds of sea turtles in the world.",
                correct: true
            },
            {
                statement: "4. Sea turtles are very small.",
                correct: false
            },
            {
                statement: "5. Turtles come ashore to lay eggs.",
                correct: true
            },
            {
                statement: "6. Sea turtles come to rest on land.",
                correct: false
            },
            {
                statement: "7. Olive Ridleys are the only sea turtles seen on Indian shores.",
                correct: false
            }
        ];

        let currentQuestionIndex = 0;
        let correctAnswers = 0;

        function showQuestion(index) {
            const quizItems = document.querySelector('.quiz-items');
            const question = quizQuestions[index];
            
            quizItems.innerHTML = `
                <div class="quiz-item" data-correct="${question.correct}">
                    <span class="statement">${question.statement}</span>
                    <div class="answer-buttons">
                        <button class="answer-btn" onclick="checkAnswer(true)">✓</button>
                        <button class="answer-btn" onclick="checkAnswer(false)">✗</button>
                    </div>
                </div>
            `;

            // Update progress bar - adjust calculation to include current question
            const progress = ((index + 1) / quizQuestions.length) * 100;
            document.querySelector('.progress').style.width = `${progress}%`;
            document.getElementById('currentQuestion').textContent = index + 1;

            // Add speech functionality to the question
            const questionText = document.querySelector('.statement');
            if (questionText) {
                questionText.style.cursor = 'pointer';
                questionText.addEventListener('click', () => {
                    const speechManager = new SpeechManager();
                    speechManager.speak(questionText.textContent);
                });
            }
        }

        function checkAnswer(userAnswer) {
            const currentQuestion = quizQuestions[currentQuestionIndex];
            const isCorrect = userAnswer === currentQuestion.correct;
            
            // Play sound effect
            const sound = new Audio(isCorrect ? '/sounds/success.mp3' : '/sounds/fail.mp3');
            sound.play();

            // Show feedback
            showFeedback(isCorrect);

            if (isCorrect) correctAnswers++;

            // Wait for feedback animation
            setTimeout(() => {
                currentQuestionIndex++;
                
                if (currentQuestionIndex < quizQuestions.length) {
                    showQuestion(currentQuestionIndex);
                } else {
                    showFinalResults();
            }
        }, 1000);
        }

        function showFeedback(isCorrect) {
            const feedback = document.createElement('div');
            feedback.className = 'feedback-overlay';
            feedback.textContent = isCorrect ? '✓' : '✗';
            feedback.style.color = isCorrect ? '#2ECC71' : '#E74C3C';
            document.body.appendChild(feedback);
            
            setTimeout(() => feedback.remove(), 1000);
        }

        // Update the showFinalResults function to move the continue button
        function showFinalResults() {
            const resultBoard = document.querySelector('.result-board');
            const percentage = Math.round((correctAnswers / quizQuestions.length) * 100);
            const badgesContainer = document.querySelector('.badges-container');
            
            document.getElementById('score').textContent = correctAnswers;
            document.getElementById('percentage').textContent = percentage;
            document.getElementById('correctCount').textContent = correctAnswers;
            document.getElementById('incorrectCount').textContent = quizQuestions.length - correctAnswers;
            
            // Clear previous badges
            badgesContainer.innerHTML = '';
            
            // Add badge and message based on score
            let badgeImg, message;
            if (percentage === 100) {
                badgeImg = '/img/gold-badge.png';
                message = 'Outstanding! You\'ve earned the Gold Badge! 🌟';
                createCelebration();
                const successSound = new Audio('/sounds/success.mp3');
                successSound.play();
            } else if (percentage >= 80) {
                badgeImg = '/img/silver-badge.png';
                message = 'Great job! You\'ve earned the Silver Badge! 🎉';
            } else if (percentage >= 60) {
                badgeImg = '/img/bronze-badge.png';
                message = 'Good effort! You\'ve earned the Bronze Badge! 👍';
                        } else {
                badgeImg = '/img/try-again.png';
                message = 'Keep practicing! You can do better! 💪';
            }

            // Add badge without the continue button
            badgesContainer.innerHTML = `
                <div class="badge-container">
                    <img src="${badgeImg}" class="badge" alt="Achievement Badge">
                    <div class="badge-glow"></div>
                        </div>
                <p class="badge-message">${message}</p>
            `;

            // Update the navigation buttons container
            const navButtons = document.querySelector('.nav-buttons');
            navButtons.innerHTML = `
                <button class="back-button" onclick="goBack()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 17l-5-5m0 0l5-5m-5 5h12"/>
                    </svg>
                    Go Back
                </button>
                <button class="nav-button" onclick="completeLevel()">
                    Continue to Glossary
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                    </svg>
                </button>
            `;

            // Add style for nav buttons if not already present
            if (!document.getElementById('navButtonsStyle')) {
                const style = document.createElement('style');
                style.id = 'navButtonsStyle';
                style.textContent = `
                    .nav-buttons {
                        display: flex;
                        justify-content: space-between;
                        gap: 1rem;
                        margin-top: 2rem;
                    }
                `;
                document.head.appendChild(style);
            }
            
            resultBoard.style.display = 'block';
        }

        function initializeQuiz() {
            currentQuestionIndex = 0;
            correctAnswers = 0;
            showQuestion(0);
            
            const resultBoard = document.querySelector('.result-board');
            if (resultBoard) {
                resultBoard.style.display = 'none';
            }
        }

        function resetQuiz() {
            initializeQuiz();
        }

        function createCelebration() {
            const celebration = document.createElement('div');
            celebration.className = 'celebration';
            document.body.appendChild(celebration);
            
            // Fire multiple confetti bursts
            const duration = 3000;
            const animationEnd = Date.now() + duration;
            const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };

            function randomInRange(min, max) {
                return Math.random() * (max - min) + min;
            }

            const interval = setInterval(function() {
                const timeLeft = animationEnd - Date.now();

                if (timeLeft <= 0) {
                    return clearInterval(interval);
                }

                const particleCount = 50 * (timeLeft / duration);
                
                // Since particles fall down, start a bit higher than random
                confetti(Object.assign({}, defaults, { 
                    particleCount,
                    origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 }
                }));
                confetti(Object.assign({}, defaults, { 
                    particleCount,
                    origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 }
                }));
            }, 250);

            // Add some special effects
            setTimeout(() => {
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 },
                    colors: ['#FFD700', '#FFA500', '#FF4500']  // Gold, orange, red
                });
            }, 500);

            setTimeout(() => {
                confetti({
                    particleCount: 100,
                    angle: 60,
                    spread: 55,
                    origin: { x: 0 },
                    colors: ['#FF9B3F', '#2ECC71', '#3498DB']  // Theme colors
                });
                confetti({
                    particleCount: 100,
                    angle: 120,
                    spread: 55,
                    origin: { x: 1 },
                    colors: ['#FF9B3F', '#2ECC71', '#3498DB']  // Theme colors
                });
            }, 1000);

            setTimeout(() => celebration.remove(), 3000);
        }

        // Add initialization function for the glossary level
        function initializeGlossary() {
            const words = document.querySelectorAll('.word');
            const definitions = document.querySelectorAll('.definition');
            let correctMatches = 0;

            // Add the enhanced styles
            if (!document.getElementById('glossaryStyles')) {
                const style = document.createElement('style');
                style.id = 'glossaryStyles';
                style.textContent = `
                    .glossary-container {
                        background: linear-gradient(180deg, #87CEEB 0%, #1E90FF 100%),
                                    url('/img/underwater-bg.png');
                        background-blend-mode: soft-light;
                        padding: 3rem;
                    }

                    .glossary-instructions {
                        font-size: 1.8rem;
                        color: white;
                        text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
                        background: rgba(255, 255, 255, 0.1);
                        padding: 1rem;
                        border-radius: 15px;
                        backdrop-filter: blur(5px);
                    }

                    .word {
                        background: linear-gradient(135deg, #fff 0%, #f0f0f0 100%);
                        transform-style: preserve-3d;
                        transition: all 0.3s ease;
                    }

                    .word:hover {
                        transform: translateY(-5px) rotateX(10deg);
                        box-shadow: 0 10px 20px rgba(0,0,0,0.2);
                    }

                    .definition {
                        transition: all 0.3s ease;
                        background: rgba(255, 255, 255, 0.1);
                        backdrop-filter: blur(5px);
                    }

                    .definition.hover {
                        transform: scale(1.02);
                        box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
                    }

                    .definition.correct {
                        animation: correctMatch 0.5s ease-out;
                        border-color: #2ECC71;
                        background: rgba(46, 204, 113, 0.1);
                    }

                    .definition.incorrect {
                        animation: incorrectMatch 0.5s ease-out;
                        border-color: #E74C3C;
                        background: rgba(231, 76, 60, 0.1);
                    }

                    @keyframes correctMatch {
                        0% { transform: scale(1); }
                        50% { transform: scale(1.05); }
                        100% { transform: scale(1); }
                    }

                    @keyframes incorrectMatch {
                        0% { transform: translateX(0); }
                        25% { transform: translateX(-10px); }
                        75% { transform: translateX(10px); }
                        100% { transform: translateX(0); }
                    }

                    .glossary-feedback {
                        position: fixed;
                        top: 50%;
                        left: 50%;
                        transform: translate(-50%, -50%);
                        font-size: 6rem;
                        z-index: 1000;
                        text-shadow: 0 0 20px rgba(255,255,255,0.5);
                        animation: feedbackPop 0.8s cubic-bezier(0.36, 0, 0.66, -0.56);
                        pointer-events: none;
                    }
                `;
                document.head.appendChild(style);
            }

            // Rest of the initializeGlossary function remains the same
            function showFeedback(isCorrect) {
                const feedback = document.createElement('div');
                feedback.className = 'glossary-feedback';
                feedback.textContent = isCorrect ? '✓' : '✗';
                feedback.style.color = isCorrect ? '#2ECC71' : '#E74C3C';
                document.body.appendChild(feedback);
                
                setTimeout(() => feedback.remove(), 800);
            }

            words.forEach(word => {
                word.addEventListener('dragstart', (e) => {
                    word.classList.add('dragging');
                    e.dataTransfer.setData('text/plain', word.dataset.word);
                });

                word.addEventListener('dragend', () => {
                    word.classList.remove('dragging');
                });
            });

            definitions.forEach(def => {
                def.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    def.classList.add('hover');
                });

                def.addEventListener('dragleave', () => {
                    def.classList.remove('hover');
                });

                def.addEventListener('drop', (e) => {
                    e.preventDefault();
                    def.classList.remove('hover');
                    const word = e.dataTransfer.getData('text/plain');
                    
                    if (word === def.dataset.definition) {
                        def.classList.add('correct');
                        correctMatches++;
                        
                        // Play success sound and show feedback
                        const successSound = new Audio('/sounds/success.mp3');
                        successSound.play();
                        showFeedback(true);
                        
                        // Move the word into the definition
                        const draggedWord = document.querySelector(`[data-word="${word}"]`);
                        def.appendChild(draggedWord);
                        draggedWord.setAttribute('draggable', 'false');
                        
                        if (correctMatches === definitions.length) {
                            setTimeout(() => {
                                createCelebration();
                                const successSound = new Audio('/sounds/success.mp3');
                                successSound.play();
                            }, 500);
                        }
                    } else {
                        // Play fail sound and show feedback
                        const failSound = new Audio('/sounds/fail.mp3');
                        failSound.play();
                        showFeedback(false);
                        
                        def.classList.add('incorrect');
                        setTimeout(() => def.classList.remove('incorrect'), 1000);
                    }
                });
            });
        }

        // Update the interactive word click handler
        function makeWordsInteractive() {
            const interactiveWords = document.querySelectorAll('.interactive-word');
            const speechManager = new SpeechManager();

            interactiveWords.forEach(word => {
                word.addEventListener('click', (e) => {
                    e.preventDefault();
                    speechManager.speak(word.textContent);
                });
            });
        }

        // Update the paragraph click handler
        function makeParagraphsInteractive() {
            const paragraphs = document.querySelectorAll('.content-paragraph');
            const speechManager = new SpeechManager();

            paragraphs.forEach(paragraph => {
                paragraph.style.cursor = 'pointer';
                paragraph.addEventListener('click', (e) => {
                    e.preventDefault();
                    speechManager.speak(paragraph.textContent);
                });
            });
        }
    </script>
</body>
</html> 
